<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ—Ü–∏–∞–ª–µ–Ω –∫–æ–º–ø–∞—Å: –†–æ–±–∏–Ω–∑–æ–Ω –ö—Ä—É–∑–æ –∏ AI</title>
    
    <link rel="manifest" href="manifest.webmanifest">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f8f8f8; }
        .hidden { display: none; }
        .modal { background: rgba(0,0,0,0.8); }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞ –ø—É–ª—Å–∏—Ä–∞–Ω–µ –ø—Ä–∏ –∞–ª–∞—Ä–º–∞ */
        .pulse-red { animation: pulse-animation 2s infinite; }
        @keyframes pulse-animation {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col items-center">

    <header class="w-full bg-green-600 text-white p-4 text-center shadow-md fixed top-0 z-10">
        <h1 class="text-xl font-bold uppercase tracking-wider mb-2">–°–æ—Ü–∏–∞–ª–µ–Ω –ö–æ–º–ø–∞—Å</h1>
        <div id="motto-container" class="text-sm italic font-light h-6 transition-opacity duration-500 ease-in-out opacity-100">
            –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –¥–Ω–µ–≤–Ω–æ—Ç–æ –º–æ—Ç–æ...
        </div>
    </header>

    <main class="mt-28 w-full max-w-md px-4 flex flex-col gap-6 mb-20">
        
        <div class="bg-white rounded-2xl shadow-lg p-6 flex justify-between items-center">
            <div class="text-center">
                <p class="text-xs text-gray-500 uppercase">–ö–æ—Ä—Ç–∏–∑–æ–ª</p>
                <p id="cortisol-val" class="text-2xl font-bold text-red-500">20</p>
            </div>
            <div class="h-10 w-px bg-gray-200"></div>
            <div class="text-center">
                <p class="text-xs text-gray-500 uppercase">–ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏</p>
                <p id="endorphin-val" class="text-2xl font-bold text-green-500">80</p>
            </div>
        </div>

        <div id="timer-card" class="bg-white rounded-2xl shadow-xl p-8 text-center border-2 border-transparent">
            <h2 class="text-gray-500 text-sm mb-2">–ö–†–£–ó–û –ê–õ–ê–†–ú</h2>
            <div id="timer-display" class="text-6xl font-mono font-bold text-gray-800 mb-6">00:00</div>
            
            <div class="flex gap-4 justify-center">
                <button id="startBtn" onclick="startTimer()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-bold shadow transition transform hover:scale-105">
                    –°–¢–ê–†–¢
                </button>
                <button id="stopBtn" onclick="stopTimer()" class="bg-red-400 hover:bg-red-500 text-white px-8 py-3 rounded-full font-bold shadow transition hidden">
                    –°–¢–û–ü
                </button>
            </div>
            <p class="mt-4 text-xs text-gray-400">–ü—Ä–∞–≥ –Ω–∞ –∞–ª–∞—Ä–º–∞—Ç–∞: 50 –º–∏–Ω</p>
            <p id="total-time" class="mt-1 text-xs text-blue-400">–û–±—â–æ –≤—Ä–µ–º–µ –¥–Ω–µ—Å: 0 –º–∏–Ω</p>
        </div>

        <button id="installBtn" class="hidden w-full bg-blue-600 text-white py-3 rounded-xl shadow-lg font-bold">
            üì≤ –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ
        </button>

    </main>

    <audio id="alarmSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3" preload="auto"></audio>

    <div id="alarmModal" class="modal fixed inset-0 flex items-center justify-center hidden z-50 px-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center shadow-2xl animate-bounce">
            <div class="text-5xl mb-4">üö®</div>
            <h2 class="text-2xl font-bold text-red-600 mb-2">–í–†–ï–ú–ï–¢–û –ò–ó–¢–ï–ß–ï!</h2>
            <p class="text-gray-600 mb-6">–î–æ—Å—Ç–∏–≥–Ω–∞—Ö—Ç–µ –ª–∏–º–∏—Ç–∞ –æ—Ç 50 –º–∏–Ω—É—Ç–∏. –ù–∏–≤–∞—Ç–∞ –Ω–∞ –ö–æ—Ä—Ç–∏–∑–æ–ª —Å–∞ –≤–∏—Å–æ–∫–∏. –¢—Ä—è–±–≤–∞ –¥–∞ –¥–µ–π—Å—Ç–≤–∞—Ç–µ!</p>
            <button onclick="acceptMission()" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold mb-3 shadow">
                –ò–ó–ü–™–õ–ù–ò –§–í–° –ú–ò–°–ò–Ø
            </button>
            <button onclick="refuseMission()" class="w-full bg-gray-200 text-gray-700 py-3 rounded-xl font-bold">
                –û—Ç–∫–∞–∑–≤–∞–º (–†–∏—Å–∫!)
            </button>
        </div>
    </div>

    <div id="ethicalModal" class="modal fixed inset-0 flex items-center justify-center hidden z-50 px-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl overflow-y-auto max-h-[90vh]">
            <h2 class="text-xl font-bold text-purple-700 mb-4 border-b pb-2">–ï—Ç–∏—á–µ–Ω –§–∏–ª—Ç—ä—Ä</h2>
            <p class="text-sm text-gray-500 mb-4">–ö–∞–∑—É—Å "–ê–¥–∞–º –†–µ–π–Ω": –û—Ç–≥–æ–≤–æ—Ä–∏ —á–µ—Å—Ç–Ω–æ.</p>
            
            <form id="ethicalForm" onsubmit="processEthics(event)">
                <div class="mb-4">
                    <p class="font-bold text-sm mb-2">1. –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç–µ –ª–∏ –¥–∞ —Ç—ä—Ä—Å–∏—Ç–µ –ø–æ–¥–∫—Ä–µ–ø–∞ –æ—Ç AI, –≤–º–µ—Å—Ç–æ –¥–∞ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å –¥—Ä—É–≥–∏ —Ö–æ—Ä–∞?</p>
                    <div class="flex gap-4">
                        <label><input type="radio" name="q1" value="yes" required> –î–∞</label>
                        <label><input type="radio" name="q1" value="no"> –ù–µ</label>
                    </div>
                </div>
                <div class="mb-4">
                    <p class="font-bold text-sm mb-2">2. –ß—Ä–µ–∑ –∏–∑–∫—É—Å—Ç–≤–µ–Ω–∏—è –∏–Ω—Ç–µ–ª–µ–∫—Ç –º–æ–∂–µ–º –ª–∏ –¥–∞ –∏–∑–±—è–≥–∞–º–µ –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ç–µ —Å–∏ –ø—Ä–æ–±–ª–µ–º–∏?</p>
                    <div class="flex gap-4">
                        <label><input type="radio" name="q2" value="yes" required> –î–∞</label>
                        <label><input type="radio" name="q2" value="no"> –ù–µ</label>
                    </div>
                </div>
                <div class="mb-6">
                    <p class="font-bold text-sm mb-2">3. –ü—Ä–µ–Ω–µ–±—Ä–µ–≥–≤–∞—Ç–µ –ª–∏ –æ—Å–Ω–æ–≤–Ω–∏—Ç–µ —Å–∏ –Ω—É–∂–¥–∏, –∑–∞ –¥–∞ –ø—Ä–µ–∫–∞—Ä–∞—Ç–µ –ø–æ–≤–µ—á–µ –≤—Ä–µ–º–µ –Ω–∞ –µ–∫—Ä–∞–Ω–∞?</p>
                    <div class="flex gap-4">
                        <label><input type="radio" name="q3" value="yes" required> –î–∞</label>
                        <label><input type="radio" name="q3" value="no"> –ù–µ</label>
                    </div>
                </div>
                <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-xl font-bold hover:bg-purple-700">
                    –ü–†–û–í–ï–†–ò –†–ï–ó–£–õ–¢–ê–¢–ê
                </button>
            </form>
        </div>
    </div>

    <div id="crisisModal" class="modal fixed inset-0 flex items-center justify-center hidden z-50 px-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center border-4 border-red-500">
            <div class="text-4xl mb-2">üÜò</div>
            <h2 class="text-xl font-bold text-red-700 mb-4">–í–ò–°–û–ö –†–ò–°–ö –û–¢ –ó–ê–í–ò–°–ò–ú–û–°–¢!</h2>
            <p class="text-sm text-gray-700 mb-4">–í–∏–µ –ø–æ–∫–∞–∑–∞—Ö—Ç–µ –ø—Ä–∏–∑–Ω–∞—Ü–∏ –Ω–∞ –¥–∏–≥–∏—Ç–∞–ª–Ω–∞ –∏–∑–æ–ª–∞—Ü–∏—è. –°–≤—ä—Ä–∂–µ—Ç–µ —Å–µ —Å –ø–æ–º–æ—â —Å–µ–≥–∞:</p>
            
            <div class="bg-red-50 p-3 rounded-lg mb-2 text-left">
                <p class="font-bold text-red-800">–ù–∞—Ü–∏–æ–Ω–∞–ª–Ω–∞ –ª–∏–Ω–∏—è –∑–∞ –ø–æ–¥–∫—Ä–µ–ø–∞</p>
                <a href="tel:116111" class="text-2xl font-bold text-red-600 block">üìû 116 111</a>
            </div>
            
            <div class="bg-red-50 p-3 rounded-lg mb-6 text-left">
                <p class="font-bold text-red-800">–ü–æ–º–æ—â –ø—Ä–∏ –¥–æ–º–∞—à–Ω–æ –Ω–∞—Å–∏–ª–∏–µ</p>
                <a href="tel:080011977" class="text-xl font-bold text-red-600 block">üìû 0800 11 977</a>
            </div>

            <p class="text-xs text-gray-500 mb-4">–ê–∫–æ —Å–µ —á—É–≤—Å—Ç–≤–∞—Ç–µ –ø–æ-–¥–æ–±—Ä–µ, –º–æ–∂–µ—Ç–µ –¥–∞ —Å–µ –≤—ä—Ä–Ω–µ—Ç–µ –∏ –¥–∞ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ –º–∏—Å–∏—è—Ç–∞.</p>
            <button onclick="backToMissionFromCrisis()" class="w-full bg-gray-800 text-white py-3 rounded-xl font-bold">
                –í—ä—Ä–Ω–∏ —Å–µ –∫—ä–º –§–í–° –ú–∏—Å–∏—è
            </button>
        </div>
    </div>

    <div id="missionModal" class="modal fixed inset-0 flex items-center justify-center hidden z-50 px-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full text-center">
            <h2 class="text-2xl font-bold text-green-600 mb-2">–í–ê–®–ê–¢–ê –ú–ò–°–ò–Ø</h2>
            <div id="missionContent" class="bg-green-100 p-4 rounded-xl mb-6 min-h-[100px] flex items-center justify-center text-lg font-bold text-green-900">
                </div>
            <p class="text-sm text-gray-500 mb-4">–ù–∞–≥—Ä–∞–¥–∞: –ö–æ—Ä—Ç–∏–∑–æ–ª -15 | –ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏ +25</p>
            <button onclick="completeMission()" class="w-full bg-green-500 text-white py-3 rounded-xl font-bold hover:bg-green-600 shadow-lg">
                ‚úÖ –ò–ó–ü–™–õ–ù–ò–• –ú–ò–°–ò–Ø–¢–ê
            </button>
        </div>
    </div>

    <script>
        // --- –î–ê–ù–ù–ò –û–¢ –§–û–†–ú–£–õ–Ø–†–ê ---
        const MOTTOES = [
            "–ú—ä—Ä–∑–µ–ª—ä—Ç –Ω—è–º–∞ –¥–∞ —Ç–µ –¥–æ–≤–µ–¥–µ –¥–æ –Ω–∏–∫—ä–¥–µ.",
            "–°–≤–µ—Ç—ä—Ç –µ –æ—Ç–≤—ä–Ω, –Ω–µ –≤ –µ–∫—Ä–∞–Ω–∞.",
            "–ì–æ–≤–æ—Ä–∏ —Å —Ö–æ—Ä–∞, –∞ –Ω–µ —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞.",
            "–î–≤–∏–∂–µ–Ω–∏–µ—Ç–æ –µ –ª–µ–∫—ä—Ç –Ω–∞ –∂–∏–≤–æ—Ç–∞.",
            "–î–æ—Ä–∏ –∏ –Ω–∞–π-–º–∞–ª–∫–∞—Ç–∞ –≤—è—Ä–∞ –º–æ–∂–µ –¥–∞ —Ç–∏ –ø–æ–º–æ–≥–Ω–µ –≤ –Ω–∞–π-—Ç—Ä—É–¥–Ω–∏—Ç–µ —Ç–∏ –¥–Ω–∏."
        ];

        const MISSIONS = [
            { title: "–ö–ª–µ–∫–æ–≤–µ", text: "60 –∫–ª–µ–∫–∞ –¥–æ –¥–æ–ª—É —Å –∏–∑–ø—ä–Ω–∞—Ç–∏ —Ä—ä—Ü–µ" },
            { title: "Jumping Jacks", text: "30 –¥–æ 40 –±—ä—Ä–∑–∏ –ø–æ–¥—Å–∫–æ–∫–∞ (Jumping Jacks)" },
            { title: "–ë–∞–≤–Ω–æ —Ç–∏—á–∞–Ω–µ", text: "5 –∫–º –¥–∂–æ–≥–∏–Ω–≥ (–∏–ª–∏ 5 –º–∏–Ω –±—è–≥–∞–Ω–µ –Ω–∞ –º—è—Å—Ç–æ)" },
            { title: "–ü–ª–∞–Ω–∫", text: "2 –º–∏–Ω. –ø–ª–∞–Ω–∫ –Ω–∞ –ª–∞–∫—Ç–∏, –∏–∑–ø—ä–Ω–∞—Ç–æ —Ç—è–ª–æ" }
        ];

        // --- –ü–†–û–ú–ï–ù–õ–ò–í–ò ---
        let timerInterval;
        let startTime;
        let elapsedTime = 0; // –í—Ä–µ–º–µ –≤ —Å–µ–∫—É–Ω–¥–∏ –∑–∞ —Ç–µ–∫—É—â–∞—Ç–∞ —Å–µ—Å–∏—è
        let totalTime = 0; // –û–±—â–æ –≤—Ä–µ–º–µ
        const ALARM_THRESHOLD = 50 * 60; // 50 –º–∏–Ω –≤ —Å–µ–∫—É–Ω–¥–∏
        let cortisol = 20;
        let endorphins = 80;
        let isRunning = false;

        // --- MOTTO ROTATION ---
        let mottoIndex = 0;
        function rotateMotto() {
            const el = document.getElementById('motto-container');
            el.style.opacity = 0;
            setTimeout(() => {
                el.innerText = MOTTOES[mottoIndex];
                el.style.opacity = 1;
                mottoIndex = (mottoIndex + 1) % MOTTOES.length;
            }, 500);
        }
        setInterval(rotateMotto, 5000); // –°–º—è–Ω–∞ –Ω–∞ 5 —Å–µ–∫—É–Ω–¥–∏
        rotateMotto(); // –ü—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–æ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ

        // --- TIMER LOGIC ---
        function updateDisplay() {
            const minutes = Math.floor(elapsedTime / 60);
            const seconds = elapsedTime % 60;
            document.getElementById('timer-display').innerText = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –∞–ª–∞—Ä–º–∞
            if (elapsedTime >= ALARM_THRESHOLD && isRunning) {
                triggerAlarm();
            }

            // –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –æ–±—â–æ—Ç–æ –≤—Ä–µ–º–µ
            const totalMins = Math.floor((totalTime + elapsedTime) / 60); // –°–∞–º–æ –∑–∞ –¥–∏—Å–ø–ª–µ—è, –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª–Ω–æ
            document.getElementById('total-time').innerText = `–û–±—â–æ –≤—Ä–µ–º–µ –¥–Ω–µ—Å: ${totalMins} –º–∏–Ω`;
        }

        function startTimer() {
            if (isRunning) return;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ –∞—É–¥–∏–æ—Ç–æ (–∑–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ –Ω–∞ –º–æ–±–∏–ª–Ω–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
            document.getElementById('alarmSound').play().then(() => {
                document.getElementById('alarmSound').pause();
                document.getElementById('alarmSound').currentTime = 0;
            }).catch(e => console.log("Audio permission needed"));

            isRunning = true;
            startTime = Date.now() - (elapsedTime * 1000);
            document.getElementById('startBtn').classList.add('hidden');
            document.getElementById('stopBtn').classList.remove('hidden');

            timerInterval = setInterval(() => {
                const now = Date.now();
                const diff = Math.floor((now - startTime) / 1000);
                
                // –•–æ—Ä–º–æ–Ω–∞–ª–Ω–∞ –ª–æ–≥–∏–∫–∞ –Ω–∞ –≤—Å–µ–∫–∏ 5 –º–∏–Ω—É—Ç–∏ (300 —Å–µ–∫)
                if (diff > elapsedTime && diff % 300 === 0) {
                    updateHormones(5, -5); // –ö–æ—Ä—Ç–∏–∑–æ–ª —Å–µ –∫–∞—á–≤–∞, –ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏ –ø–∞–¥–∞—Ç
                }

                elapsedTime = diff;
                updateDisplay();
            }, 1000);
        }

        function stopTimer() {
            if (!isRunning) return;
            isRunning = false;
            clearInterval(timerInterval);
            totalTime += elapsedTime; // –ó–∞–ø–∞–∑–≤–∞–º–µ –≤ –æ–±—â–æ—Ç–æ
            // –ù–µ –Ω—É–ª–∏—Ä–∞–º–µ elapsedTime, –∑–∞ –¥–∞ –º–æ–∂–µ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏, –æ—Å–≤–µ–Ω –∞–∫–æ –Ω–µ –µ –º–∏—Å–∏—è
            document.getElementById('startBtn').classList.remove('hidden');
            document.getElementById('stopBtn').classList.add('hidden');
        }

        function updateHormones(cortChange, endoChange) {
            cortisol += cortChange;
            endorphins += endoChange;
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è 0-100
            if (cortisol < 0) cortisol = 0; if (cortisol > 100) cortisol = 100;
            if (endorphins < 0) endorphins = 0; if (endorphins > 100) endorphins = 100;

            document.getElementById('cortisol-val').innerText = cortisol;
            document.getElementById('endorphin-val').innerText = endorphins;
        }

        // --- ALARM & MODALS ---
        function triggerAlarm() {
            stopTimer();
            document.getElementById('alarmSound').play();
            document.getElementById('timer-card').classList.add('pulse-red');
            document.getElementById('alarmModal').classList.remove('hidden');
        }

        function acceptMission() {
            document.getElementById('alarmModal').classList.add('hidden');
            document.getElementById('timer-card').classList.remove('pulse-red');
            document.getElementById('alarmSound').pause();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Å–ª—É—á–∞–π–Ω–∞ –º–∏—Å–∏—è
            const randomMission = MISSIONS[Math.floor(Math.random() * MISSIONS.length)];
            document.getElementById('missionContent').innerHTML = 
                `<strong>${randomMission.title}</strong><br>${randomMission.text}`;
            
            document.getElementById('missionModal').classList.remove('hidden');
        }

        function refuseMission() {
            document.getElementById('alarmModal').classList.add('hidden');
            document.getElementById('alarmSound').pause();
            // –û—Ç–≤–∞—Ä—è–Ω–µ –Ω–∞ –ï—Ç–∏—á–µ–Ω —Ñ–∏–ª—Ç—ä—Ä
            document.getElementById('ethicalModal').classList.remove('hidden');
        }

        function completeMission() {
            // –ü—Ä–∏–ª–∞–≥–∞–Ω–µ –Ω–∞ –∫–æ—Ä–µ–∫—Ü–∏–∏—Ç–µ –æ—Ç —Ñ–æ—Ä–º—É–ª—è—Ä–∞
            updateHormones(-15, 25); // –ö–æ—Ä—Ç–∏–∑–æ–ª –ø–∞–¥–∞, –ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏ —Å–µ –∫–∞—á–≤–∞—Ç
            
            // –ù—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ —Å–µ—Å–∏—è—Ç–∞
            elapsedTime = 0;
            updateDisplay();
            
            document.getElementById('missionModal').classList.add('hidden');
            alert("–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è! –•–æ—Ä–º–æ–Ω–∞–ª–Ω–∏—è—Ç –±–∞–ª–∞–Ω—Å –µ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω.");
        }

        function processEthics(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            let yesCount = 0;
            
            for (let [key, value] of formData.entries()) {
                if (value === 'yes') yesCount++;
            }

            document.getElementById('ethicalModal').classList.add('hidden');
            e.target.reset(); // –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞

            if (yesCount >= 2) {
                // –í–∏—Å–æ–∫ —Ä–∏—Å–∫ -> –ö—Ä–∏–∑–∏—Å–Ω–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∏
                document.getElementById('crisisModal').classList.remove('hidden');
            } else {
                // –ù–∏—Å—ä–∫ —Ä–∏—Å–∫ -> –û–±—Ä–∞—Ç–Ω–æ –∫—ä–º –º–∏—Å–∏—è—Ç–∞
                alert("–†–∏—Å–∫—ä—Ç –µ –Ω–∏—Å—ä–∫, –Ω–æ –±–∞–ª–∞–Ω—Å—ä—Ç –µ –Ω—É–∂–µ–Ω.");
                acceptMission();
            }
        }

        function backToMissionFromCrisis() {
            document.getElementById('crisisModal').classList.add('hidden');
            acceptMission();
        }

        // --- PWA INSTALLATION LOGIC ---
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.classList.remove('hidden');
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    installBtn.classList.add('hidden');
                }
                deferredPrompt = null;
            }
        });

        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(() => console.log('Service Worker Registered'));
        }
    </script>
</body>
</html>
